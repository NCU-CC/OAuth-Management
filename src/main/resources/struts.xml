<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>

    <constant name="struts.enable.DynamicMethodInvocation" value="false" />
    <constant name="struts.devMode" value="true" />
    <constant name="struts.action.extension" value=","/>
    
    <package name="default" extends="struts-default" abstract="true">
	    <interceptors>
	    <interceptor name="loginInterceptor" class="loginInterceptor"></interceptor>
	    </interceptors>
	    <global-results>
	        <result name="login" type="redirect">/login</result>
	    </global-results>
    
    </package>
    
	<package name="main" extends="default" namespace="/">
	   <action name="login" class="loginController">
            <result name="success">jsps/login.jsp</result>
            <result name="error">500.html</result>
        </action>   
		<action name="auth" class="authController">
			<result name="success" type="redirect">logined</result>
			<result name="error">500.html</result>
		</action>
		<action name="logined" class="afterLoginController">
            <result name="success" type="redirect">/</result>
            <result name="error">500.html</result>
        </action>		     
        <action name="" class="mainpageController">
            <result name="success">jsps/index.jsp</result>
             <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>           
        </action>
        <action name="index" class="mainpageController">
            <result name="success">jsps/index.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>
        <action name="logout" class="logoutController">
            <result name="success" type="redirect">/</result>
            <result name="error">500.html</result>
        </action>
        <action name="terms" class="mainpageController">
            <result name="success">/jsps/terms.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>
        <action name="about" class="mainpageController">
            <result name="success">/jsps/about.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>
	</package>
	
	<package name="teach" extends="default" namespace="/tutorial">		
	    <action name="user" class="mainpageController">
	        <result name="success">/jsps/teachuser.jsp</result>
	        <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
	    </action>
	    <action name="dev" class="mainpageController">
            <result name="success">/jsps/teachdev.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>	    
	</package>
	
	   <package name="user" extends="default" namespace="/user">        
        <action name="list" class="tokenListController">
            <result name="success">/jsps/authorizedapplist.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action> 
        <action name="cancel" class="tokenListController" method="remove">
            <result name="success">/jsps/authorizedappdeletesuc.jsp</result>
            <result name="input" >/jsps/authorizedappdeletefail.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>
    </package>
    
        <package name="dev" extends="default" namespace="/dev">
        <interceptors>
            <interceptor name="APPInterceptor" class="APPInterceptor"></interceptor>
        </interceptors>        
        <global-results>           
           <result name="error">/jsps/commonerrordev.jsp</result>
       </global-results>
        <action name="list" class="APPListController">
            <result name="success">/jsps/applist.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>
        <action name="new" class="APPNewController">        
            <result name="input">/jsps/appregister.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>    
        <action name="secret" class="APPNewController" method="update">        
            <result name="input">/jsps/appeditdeletefail.jsp</result>
            <result name="success">/jsps/appregistersuc.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action> 
        <action name="tonew" class="APPNewController" method="create">        
            <result name="input">/jsps/appregister.jsp</result>
            <result name="success">/jsps/appregistersuc.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>    
        <action name="edit" class="APPEditController">
            <result name="input">/jsps/appedit.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="APPInterceptor"></interceptor-ref> 
            <interceptor-ref name="defaultStack"></interceptor-ref>   
        </action>   
        <action name="edited" class="APPEditController" method="upload">
            <result name="success">/jsps/appeditsuc.jsp</result>
            <result name="input">/jsps/appedit.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>   
        <action name="delete" class="APPEditController" method="delete">
            <result name="success">/jsps/appeditsuc.jsp</result>
            <result name="input">/jsps/appeditdeletefail.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action>   
        <action name="api" class="mainpageController">
            <result name="success">/jsps/openfunctions.jsp</result>
            <interceptor-ref name="loginInterceptor"></interceptor-ref>
            <interceptor-ref name="defaultStack"></interceptor-ref>            
        </action> 
    </package>
	
</struts>
